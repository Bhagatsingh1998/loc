<!DOCTYPE html>
<html lang="eng">

<head>
  <title>ADMIN | LOGIN</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <script>
    addEventListener("load", function () {
      setTimeout(hideURLbar, 0);
    }, false);

    function hideURLbar() {
      window.scrollTo(0, 1);
    }
  </script>
  <link rel="stylesheet" href="./../assets/css/login.css">

</head>


<body>

  <section class="main">
    <div class="layer">
      <div class="content-w3ls">
        <div class="text-center icon">
          <img src="./../assets/images/logo.png" width="100">
          <h3>ADMIN_LOGIN</h3>
        </div>
        <div class="content-bottom">

          <div class="form">
            <div class="field-group">
              <span class="fa fa-envelope" aria-hidden="true"></span>
              <div class="wthree-field">
                <input name="text1" id="email" type="email" value="" placeholder="Email" required>
              </div>
            </div>
            <div class="field-group">
              <span class="fa fa-lock" aria-hidden="true"></span>
              <div class="wthree-field">
                <input name="password" id="password" type="Password" placeholder="Password">
              </div>
            </div>
            <div class="wthree-field">
              <button type="submit" class="btn" id="log">Login</button>
            </div>

          </div>
        </div>
      </div>
      <div class="bottom-grid1">
        <div class="links">

        </div>
        <div class="copyright">
          <p style="color:gray">Design by
            <a style="color: #000000">CrossHex @2020 </a>
          </p>
        </div>
      </div>
    </div>
  </section>

</body>


<script type="text/javascript">
  var auth = window.localStorage.getItem('Locuser');
  setInterval(function () {

    if (auth != undefined || auth != null) {

      window.location = "index.html"
    }
  }, 100);
</script>

<script src="https://www.gstatic.com/firebasejs/7.16.0/firebase.js"></script>
<script>
  var firebaseConfig = {
    apiKey: "AIzaSyATUjzcsSQMIKlEeBQqMGTy_4zugRTPILg",
    authDomain: "lake-of-cakes.firebaseapp.com",
    databaseURL: "https://lake-of-cakes.firebaseio.com",
    projectId: "lake-of-cakes",
    storageBucket: "lake-of-cakes.appspot.com",
    messagingSenderId: "779843608951",
    appId: "1:779843608951:web:48c6afe1773e2b395e8172",
    measurementId: "G-5ER0QF0FDW"
  };
  firebase.initializeApp(firebaseConfig);
</script>

<script>
  let ref = firebase.database().ref('User');
  ref.on('value', gotData, errData)
  log.addEventListener('click', logind)
  var sc, keys;

  function gotData(data) {
    sc = data.val();
    keys = Object.keys(sc);
  }

  function logind() {
    var email = document.querySelector('#email').value
    var pass = document.querySelector('#password').value
    var c = 0;
    var k;
    if (email != "" || pass != "") {
      for (var i = 0; i < keys.length; i++) {
        k = keys[i]
        if (sc[k].Email == email && sc[k].Password == btoa(pass)) {
          c++;
          break;
        }
      }
      if (c == 1) {

        token = btoa(k + "email")
        firebase.database().ref("User").child(k).update({
          token
        })
        window.localStorage.setItem('session', token);
        window.localStorage.setItem('Locuser', k);
        window.localStorage.setItem('username', sc[k].Name);
        window.location = "index.html"
      } else {
        alert("Invalid Email Id or password")
      }
    } else {
      alert("Please enter your email and password")
    }
  }
</script>

</html>